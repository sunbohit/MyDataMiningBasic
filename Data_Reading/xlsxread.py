'''
从excel中读取数据
'''
import xlrd 
from xlrd.xldate import XLDateAmbiguous

file = 'data.xlsx'

wb = xlrd.open_workbook(filename=file) #打开文件的工作簿
# wb = xlrd.open_workbook(filename=file, on_demand=True) #打开文件的工作簿，且仅加载部分到内存

ws = wb.sheet_by_name('Sheet1') #根据名字找到工作表

dataset = []

#根据行号和列号读取数据
for r in range(ws.nrows):
    col = []
    for c in range(ws.ncols):
        col.append(ws.cell(r, c).value)
        if ws.cell_type(r, c) == xlrd.XL_CELL_DATE: #检查浮点数是否为日期
            try:
                print(ws.cell_type(r, c))
                from datetime import datetime
                date_value = xlrd.xldate_as_tuple(ws.cell(r, c).value, wb.datemode)
                print(datetime(*date_value))
            except XLDateAmbiguous as e:
                print(e)
    dataset.append(col)

from pprint import pprint

pprint(dataset)
3
1.25
[[28.0,
  65.0,
  '0.833730025131149-0.988897705762865i',
  '3.85373803791938-27.0168132580039i',
  120.0,
  0.23,
  72.0,
  9.0,
  1.4000000000000001,
  1.25,
  6.023029280112979,
  3.141,
  'CDXCIX',
  1.22514845490862e-16,
  1.7724538509055159,
  0.8427007351745552],
 [4.0,
  0.8427007351745552,
  '5+12i',
  '1.09868411346781+0.455089860562227i',
  1.0,
  1.0,
  3402.0,
  -9.0,
  2.0,
  380.8865742483644,
  5.0,
  -3.1,
  'LDVLIV',
  1.0,
  2.5066282746310002,
  0.0],
 [97.0,
  0.15729926482544476,
  '1.46869393991589+2.28735528717884i',
  '8+i',
  1.0,
  12.0,
  0.9999999999999998,
  1259.999999999999,
  4.0,
  761.7731484967288,
  0.0,
  31400.0,
  'XDIX',
  0.49999999999999994,
  5.0,
  101.98166642847517],
 [0.981666428475166,
  1.0,
  '0.346573590279973+0.785398163397448i',
  '8+i',
  1.0,
  1.0,
  -3.0,
  3.0,
  2.0,
  380.8865742483644,
  2.2,
  4.0,
  'VDIV',
  0.49999999999999994,
  21.0,
  ''],
 [0.2773878036322587,
  1.0,
  '0.150514997831991+0.34109408846046i',
  0.24,
  48.0,
  5.0,
  -0.3333333333333333,
  3.0,
  -2.0,
  2.0,
  2.1,
  77.0,
  'ID',
  1.1752011936438014,
  101.98166642847517,
  ''],
 [23.0,
  13.0,
  '0.500000000038482+1.13309003554401i',
  28.0,
  105.0,
  8.0,
  1.9999999999999998,
  3.0,
  3.141592653589793,
  1.0,
  -1.48,
  3.142,
  'MMXIII',
  -1.1752011936438014,
  116.98166642847517,
  ''],
 ['10111',
  -1.0,
  '-46+9.00000000000001i',
  65.0,
  -2.0,
  -9.0,
  18.0,
  -1.0,
  25.0,
  -3.0,
  20.0,
  -3.2,
  1.0,
  0.10104906311828733,
  25.27738780363226,
  ''],
 ['1+i',
  0.9272952180016122,
  '30+60i',
  -2.0,
  2.0,
  0.0,
  10.0,
  -3.0,
  2401077.2220695755,
  4.71238898038469,
  3.0,
  31500.0,
  0.0,
  4.0,
  1.0,
  ''],
 [65.0,
  '3-4i',
  6.0,
  7.38905609893065,
  1.5,
  10.0,
  1.0,
  -9.0,
  5.656854249492381,
  0.2808203258233153,
  76.0,
  1593.0,
  -1.0,
  2.0,
  101.0,
  '']]


